(()=>{"use strict";var e={370:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.visibleForTesting=void 0,t.visibleForTesting=(e,t)=>{}},568:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AppStorage=void 0;const n=i(923);t.AppStorage=class{static save(e,t){const i=JSON.stringify(t);localStorage.setItem(e,i)}static load(e){const t=localStorage.getItem(e);return t?JSON.parse(t):null}static getFbc(){const e=document.cookie.split(";");for(const t of e){const[e,i]=t.trim().split("=");if("_fbc"===e)return decodeURIComponent(i)}}static getFbp(){var e;return null!==(e=n.Utils.getCookieByNames("_fbp","fbp"))&&void 0!==e?e:void 0}}},717:function(e,t){var i=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.CountryService=void 0,t.CountryService=class{static getCountry(e){var t,n;return i(this,void 0,void 0,(function*(){if(null===(t=e.geolocation)||void 0===t?void 0:t.country)return e.geolocation.country;const i=yield(yield fetch("https://ipapi.co/json/")).json();return null!==(n=i.country)&&void 0!==n?n:null}))}}},75:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FBC=void 0;class i{constructor(e){this.version="fb",this.fbclid=e,this.subdomainIndex=0,this.creationTime=Date.now()}static fromClid(e){return e?new i(e):null}formatted(){return`${this.version}.${this.subdomainIndex}.${this.creationTime}.${this.fbclid}`}}t.FBC=i},865:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,i,a):o(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.FormsListener=void 0;const a=i(370),s=i(119),l=i(568),c=i(717),d=i(562),u=i(554),p=i(526),v=i(923);class h{static init(){this.inited||(this.inited=!0,"complete"===document.readyState?this.startListening():window.addEventListener("load",this.startListening))}static startListening(){this.listenToForms(),new d.Observer({throttle:2e3,groupEvents:!0}).observeNewElements(document.body,(()=>{this.listenToForms()}))}static listenToForms(){Array.from(document.querySelectorAll("input, textarea")).forEach((e=>{this.canUseEl(e)&&(h.tryFill(e),e.addEventListener("input",h.handleInput),e.addEventListener("blur",h.handleInput))}))}static tryFill(e){var t,i,n,o;return r(this,void 0,void 0,(function*(){const r=yield p.Tracker.getTruthyLead(),a=h.classifyInput(e);a===s.InputType.Phone&&(e.value=null!==(t=r.phone)&&void 0!==t?t:""),a===s.InputType.Email&&(e.value=null!==(i=r.email)&&void 0!==i?i:""),a===s.InputType.Name&&(e.value=`${null!==(n=r.firstName)&&void 0!==n?n:""} ${null!==(o=r.lastName)&&void 0!==o?o:""}`)}))}static handleInput(e){return r(this,void 0,void 0,(function*(){const t=e.target,i=h.classifyInput(t),n=yield p.Tracker.getTruthyLead();if(i===s.InputType.Phone){const e=yield c.CountryService.getCountry(n),i=u.Phone.format(t.value,"BR"===e);l.AppStorage.save(p.Tracker.leadKey,Object.assign(Object.assign({},n),{phone:i}))}if(i===s.InputType.Email&&l.AppStorage.save(p.Tracker.leadKey,Object.assign(Object.assign({},n),{email:t.value})),i===s.InputType.Name){const e=t.value.split(" "),i=e[0],o=e.slice(1).join(" ");l.AppStorage.save(p.Tracker.leadKey,Object.assign(Object.assign({},n),{firstName:i,lastName:o}))}}))}static classifyInput(e){const{id:t,name:i,type:n,placeholder:o}=e;return"email"===n||(null==o?void 0:o.toLowerCase().includes("email"))||(null==t?void 0:t.toLowerCase().includes("field-email"))||(null==i?void 0:i.toLowerCase().includes("email"))?s.InputType.Email:(null==i?void 0:i.toLowerCase().includes("phone"))||(null==t?void 0:t.toLowerCase().includes("field-phone"))||(null==o?void 0:o.toLowerCase().includes("phone"))?s.InputType.Phone:(null==i?void 0:i.toLowerCase().includes("name"))||(null==t?void 0:t.toLowerCase().includes("field-name"))||(null==o?void 0:o.toLowerCase().includes("name"))?s.InputType.Name:s.InputType.Unknown}static canUseEl(e){if(this.usedIds.has(e.id))return!1;const t=v.Utils.getId(e);return this.usedIds.add(t),!0}}h.inited=!1,h.usedIds=new Set,n([a.visibleForTesting,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],h,"startListening",null),n([a.visibleForTesting,o("design:type",Function),o("design:paramtypes",[HTMLInputElement]),o("design:returntype",Promise)],h,"tryFill",null),n([a.visibleForTesting,o("design:type",Function),o("design:paramtypes",[Event]),o("design:returntype",Promise)],h,"handleInput",null),n([a.visibleForTesting,o("design:type",Function),o("design:paramtypes",[HTMLInputElement]),o("design:returntype",String)],h,"classifyInput",null),t.FormsListener=h},8:function(e,t){var i=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Ips=void 0,t.Ips=class{static getIpv4(){var e;return i(this,void 0,void 0,(function*(){try{const t=yield fetch("https://api.ipify.org?format=json").then((e=>e.json()));return null!==(e=t.ip)&&void 0!==e?e:void 0}catch(e){return void console.log("error on getIpv4",e)}}))}static getIpv6(){var e;return i(this,void 0,void 0,(function*(){try{const t=yield fetch("https://api6.ipify.org?format=json").then((e=>e.json()));return null!==(e=t.ip)&&void 0!==e?e:void 0}catch(e){return void console.log("error on getIpv6",e)}}))}}},774:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,i,a):o(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.checkoutButtonKeywors=t.checkoutLinkKeywords=t.NavigationListener=void 0;const r=i(370),a=i(562),s=i(526),l=i(923);class c{static init(){this.inited||(this.inited=!0,c.monitorLinks(),c.monitorWindowOpen(),c.monitorButtons(),c.monitorForms(),new a.Observer({throttle:2e3,groupEvents:!0}).observeNewElements(document.body,(()=>{c.monitorLinks(),c.monitorButtons(),c.monitorForms()})))}static monitorButtons(){Array.from(document.querySelectorAll("button")).forEach((e=>{this.canUseEl(e)&&e.addEventListener("click",(()=>{var t,i;c.isCheckoutButtonText(null!==(t=e.textContent)&&void 0!==t?t:"")&&(console.log("tracking ic with button",e),s.Tracker.track("InitiateCheckout")),c.isLeadButtonText(null!==(i=e.textContent)&&void 0!==i?i:"")&&(console.log("tracking lead with button",e),s.Tracker.track("Lead"))}))}))}static monitorForms(){Array.from(document.querySelectorAll("form")).forEach((e=>{this.canUseEl(e)&&e.addEventListener("submit",(t=>{var i,n;const o=e.querySelector('button[type="submit"]');console.log("submitButton",o),c.isCheckoutButtonText(null!==(i=null==o?void 0:o.textContent)&&void 0!==i?i:"")&&(console.log("tracking ic with form",e),s.Tracker.track("InitiateCheckout")),c.isLeadButtonText(null!==(n=null==o?void 0:o.textContent)&&void 0!==n?n:"")&&(console.log("tracking lead with button",o),s.Tracker.track("Lead"))}))}))}static monitorWindowOpen(){const e=window.open;window.open=function(t,i,n){return c.isCheckoutLink(null==t?void 0:t.toString(),void 0)&&s.Tracker.track("InitiateCheckout"),e(t,i||"",n||"")}}static monitorLinks(){const e=Array.from(document.querySelectorAll("a"));console.log("links to monitor",e),e.forEach((e=>{this.canUseEl(e)&&e.addEventListener("click",(()=>{var t,i;console.log("link clicked",e),c.isCheckoutLink(e.href,null!==(t=e.textContent)&&void 0!==t?t:"")&&s.Tracker.track("InitiateCheckout");const n=c.isLeadButtonText(null!==(i=e.textContent)&&void 0!==i?i:"");console.log("canSendLead",n),n&&(console.log("tracking lead with button",e),s.Tracker.track("Lead"))}))}))}static canUseEl(e){if(this.usedIds.has(e.id))return!1;const t=l.Utils.getId(e);return this.usedIds.add(t),!0}static isCheckoutLink(e,i){var n;console.log("check is checkout link: ",e);const o=s.Tracker.getTruthyLead();if(null!=o.icTextMatch)return null!==(n=null==i?void 0:i.includes(o.icTextMatch))&&void 0!==n&&n;for(const i of t.checkoutLinkKeywords)if(null==e?void 0:e.toLowerCase().includes(i.toLowerCase()))return!0;return!1}static isCheckoutButtonText(e){var i;console.log("check can iniate checkout: ",e);const n=s.Tracker.getTruthyLead();return null!=n.icTextMatch?null!==(i=null==e?void 0:e.includes(n.icTextMatch))&&void 0!==i&&i:t.checkoutButtonKeywors.some((t=>e.toLowerCase().includes(t)))}static isLeadButtonText(e){var t;console.log("check can send lead: ",e);const i=s.Tracker.getTruthyLead();return null!=i.leadTextMatch&&null!==(t=null==e?void 0:e.includes(i.leadTextMatch))&&void 0!==t&&t}}c.inited=!1,c.usedIds=new Set,n([r.visibleForTesting,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],c,"monitorButtons",null),n([r.visibleForTesting,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],c,"monitorForms",null),n([r.visibleForTesting,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],c,"monitorWindowOpen",null),n([r.visibleForTesting,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],c,"monitorLinks",null),n([r.visibleForTesting,o("design:type",Function),o("design:paramtypes",[Object,Object]),o("design:returntype",Boolean)],c,"isCheckoutLink",null),n([r.visibleForTesting,o("design:type",Function),o("design:paramtypes",[String]),o("design:returntype",Boolean)],c,"isCheckoutButtonText",null),n([r.visibleForTesting,o("design:type",Function),o("design:paramtypes",[String]),o("design:returntype",Boolean)],c,"isLeadButtonText",null),t.NavigationListener=c,t.checkoutLinkKeywords=["checkout","pagamento","payment","pay","kiwify","hotmart","eduzz","monetizze","vindi","pague","comprar","finalizar","compra","cart","carrinho","order","pedido","confirmar","confirmacao","confirmation","adoorei","vega","buygoods","octuspay","perfect","iexperience","payt","guru","green","yampi","appmax","pepper"],t.checkoutButtonKeywors=["comprar","finalizar","compra","confirmar","quero ter","proximo passo","próximo passo","inscrição","inscricao","participar","participe","quero participar","checkout"]},562:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Observer=void 0,t.Observer=class{constructor(e){var t,i;this.mutations=[],this.timer=null,this.setThrottle(null!==(t=e.throttle)&&void 0!==t?t:100),this.groupEvents=null!==(i=e.groupEvents)&&void 0!==i&&i}observeNewElements(e,t){this.callback=t,new MutationObserver(((e,t)=>{const i=this.groupEvents?1:null;(null==i||this.mutations.length<i)&&this.mutations.push({list:e,_observer:t})})).observe(e,{subtree:!0,childList:!0})}setThrottle(e){var t;this.throttle=e,null===(t=this.timer)||void 0===t||t.unref(),this.timer=setInterval((()=>{this.checkMutations()}),this.throttle)}checkMutations(){const e=this.mutations.length;for(let t=0;t<e;t++){const e=this.mutations.shift();e&&this.callback(e.list,e._observer)}}}},554:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Phone=void 0,t.Phone=class{static format(e,t=!0){const i=e.replace(/\D/g,"");let n=i;const o=t?"55":"";return t&&(i.startsWith("00")?n=i.substring(2):i.startsWith("0")&&(n=i.substring(1)),10===n.length?n=`55${n.substring(0,2)}9${n.substring(2)}`:12===n.length&&n.startsWith("55")&&(n=`55${n.substring(0,4)}9${n.substring(4)}`)),n.startsWith(o)||(n=`${o}${n}`),n.replace(/^0+/,"")}}},428:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,i,a):o(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PixelUtmify=void 0;const a=i(370),s=i(937),l=i(792),c=i(923);class d{static init(e){return r(this,void 0,void 0,(function*(){var t,i,n,o,a,s;"undefined"==typeof fbq&&(t=window,i=document,n="script",t.fbq||(o=t.fbq=function(){o.callMethod?o.callMethod.apply(o,arguments):o.queue.push(arguments)},t._fbq||(t._fbq=o),o.push=o,o.loaded=!0,o.version="2.0",o.queue=[],(a=i.createElement(n)).async=!0,a.src="https://connect.facebook.net/en_US/fbevents.js",null==(s=i.getElementsByTagName(n)[0])||s.parentNode.insertBefore(a,s))),e&&e.length>0&&(yield Promise.all(e.map((e=>r(this,void 0,void 0,(function*(){d.initedPixels.includes(e)||(yield fbq("init",e),d.initedPixels.push(e))}))))))}))}static get baseUrl(){return"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"http://localhost:3001/tracking/v1":"https://tracking.utmify.com.br/tracking/v1"}static event(e){var t,i,n,o,a,l,c,d,u,p;return r(this,void 0,void 0,(function*(){const r=`${this.baseUrl}/events`,v=yield fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>e.json()));if(console.log(`response for ${null===(t=e.lead)||void 0===t?void 0:t.pixelId}: ${null===(i=null==v?void 0:v.lead)||void 0===i?void 0:i.metaPixelIds}`),null==v.lead._id)return null;const h=new s.Lead({_id:v.lead._id,pixelId:v.lead.pixelId,userAgent:v.lead.userAgent,birthdate:v.lead.birthdate,email:v.lead.email,fbc:v.lead.fbc,fbp:v.lead.fbp,firstName:v.lead.firstName,geolocation:v.lead.geolocation,ip:v.lead.ip,ipv6:v.lead.ipv6,lastName:v.lead.lastName,metaPixelIds:v.lead.metaPixelIds,phone:v.lead.phone,parameters:v.lead.parameters,updatedAt:new Date,icTextMatch:null!==(n=v.icTextMatch)&&void 0!==n?n:null,leadTextMatch:null!==(o=v.leadTextMatch)&&void 0!==o?o:null});return"PageView"===e.type&&(yield this.init(h.metaPixelIds)),(null!==(l=null===(a=h.metaPixelIds)||void 0===a?void 0:a.length)&&void 0!==l?l:0)>0&&this.metaEvent(Object.assign(Object.assign({},e),{event:{_id:v.event._id,pageTitle:null!==(d=null===(c=e.event)||void 0===c?void 0:c.pageTitle)&&void 0!==d?d:null,sourceUrl:null!==(p=null===(u=e.event)||void 0===u?void 0:u.sourceUrl)&&void 0!==p?p:null}})),h}))}static updateLead(e){return r(this,void 0,void 0,(function*(){const t=`${this.baseUrl}/lead`;return!0===(yield fetch(t,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>e.json())))}))}static metaEvent(e){var t,i,n,o,a,s,d,u,p,v,h,f,g,y,m,b,w,T,k,_,L,x,F,I;return r(this,void 0,void 0,(function*(){const r=l.StringUtils.removeAllNonAlphaChars(null!==(n=null===(i=null===(t=e.lead)||void 0===t?void 0:t.geolocation)||void 0===i?void 0:i.city)&&void 0!==n?n:void 0),C=l.StringUtils.removeAllNonAlphaChars(null!==(s=null===(a=null===(o=e.lead)||void 0===o?void 0:o.geolocation)||void 0===a?void 0:a.state)&&void 0!==s?s:void 0),P=l.StringUtils.removeAllNonAlhaNumericChars(null!==(p=null===(u=null===(d=e.lead)||void 0===d?void 0:d.geolocation)||void 0===u?void 0:u.zipcode)&&void 0!==p?p:void 0),j=l.StringUtils.removeAllNonAlphaAccentChars(null===(v=e.lead)||void 0===v?void 0:v.firstName),O=l.StringUtils.removeAllNonAlphaAccentChars(null===(h=e.lead)||void 0===h?void 0:h.lastName);fbq("track",e.type,{event_time:c.Utils.getEventTime(),event_day:c.Utils.getEventDay(),event_day_in_month:c.Utils.getEventDayInMonth(),event_month:c.Utils.getEventMonth(),event_time_interval:c.Utils.getEventTimeInterval(),event_url:window.location.href,event_source_url:window.location.href,traffic_source:document.referrer,ct:yield c.Utils.hashValue(r),st:yield c.Utils.hashValue(C),zp:yield c.Utils.hashValue(P),client_user_agent:null===(f=e.lead)||void 0===f?void 0:f.userAgent,client_ip_address:null!==(y=null===(g=e.lead)||void 0===g?void 0:g.ipv6)&&void 0!==y?y:null===(m=e.lead)||void 0===m?void 0:m.ip,country:yield c.Utils.hashValue(null!==(T=null===(w=null===(b=e.lead)||void 0===b?void 0:b.geolocation)||void 0===w?void 0:w.country)&&void 0!==T?T:void 0),external_id:null===(k=e.lead)||void 0===k?void 0:k._id,fn:yield c.Utils.hashValue(j),ln:yield c.Utils.hashValue(O),em:yield c.Utils.hashValue(null===(_=null==e?void 0:e.lead)||void 0===_?void 0:_.email),ph:yield c.Utils.hashValue(null===(L=null==e?void 0:e.lead)||void 0===L?void 0:L.phone),fbc:null===(x=e.lead)||void 0===x?void 0:x.fbc,fbp:null===(F=e.lead)||void 0===F?void 0:F.fbp,content_type:"product",page_title:document.title},{eventID:null===(I=e.event)||void 0===I?void 0:I._id})}))}}d.initedPixels=[],n([a.visibleForTesting,o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",Promise)],d,"metaEvent",null),t.PixelUtmify=d},792:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StringUtils=void 0,t.StringUtils=class{static removeAllNonAlphaAccentChars(e){return null!=e?e.replace(/[0-9]/g,"").replace(/[^a-zA-ZÀ-ÿ\s]/g,"").replace(/[^a-zA-ZÀ-ÿ]/g,"").toLowerCase():void 0}static removeAllNonAlphaChars(e){return null!=e?e.replace(/[^a-zA-Z]/g,"").toLowerCase():void 0}static removeAllNonAlhaNumericChars(e){return null!=e?e.replace(/[^a-zA-Z0-9]/g,"").toLowerCase():void 0}}},526:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,i,a):o(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Tracker=void 0;const a=i(370),s=i(937),l=i(568),c=i(75),d=i(865),u=i(8),p=i(774),v=i(428),h=i(436);class f{static get leadKey(){return"Meta"===this.type?"lead":"lead-google"}static get pixelId(){return"Meta"===this.type?window.pixelId:window.googlePixelId}static init(e){return r(this,void 0,void 0,(function*(){if(console.log("Tracker.inited?:",this.inited),this.inited)return;this.inited=!0,this.type=e;const[t,i]=yield Promise.all([u.Ips.getIpv4(),u.Ips.getIpv6()]);f.ipv4=t,f.ipv6=i,d.FormsListener.init(),p.NavigationListener.init(),f.track("PageView"),h.ViewContentListener.init(),yield f.trySendFbp()}))}static trySendFbp(){return r(this,void 0,void 0,(function*(){const e=()=>r(this,void 0,void 0,(function*(){const e=f.getTruthyLead();(null==e?void 0:e._id)&&e.fbp&&(yield v.PixelUtmify.updateLead({_id:e._id,fbp:e.fbp}))&&l.AppStorage.save(f.leadKey,e)}));setTimeout(e,2500),setTimeout(e,5e3)}))}static track(e){return r(this,void 0,void 0,(function*(){if(this.trackedEvents.includes(e))return;this.trackedEvents.push(e);const t=this.getTruthyLead(),i=yield v.PixelUtmify.event({type:e,lead:t,event:this.getEventData()});l.AppStorage.save(this.leadKey,i)}))}static getTruthyLead(){const e=f.getLeadFromLocalStorageOrNew();return f.getLeadWithBasicFields(e)}static getLeadFromLocalStorageOrNew(){return l.AppStorage.load(this.leadKey)||new s.Lead({pixelId:this.pixelId,userAgent:navigator.userAgent,icTextMatch:null,leadTextMatch:null})}static getLeadWithBasicFields(e){const t=f.getFbc(e),i=f.getFbp(e),n=f.getGclid(e);return Object.assign(Object.assign({},e),{fbc:t,fbp:i,gclid:n,parameters:window.location.search,ip:f.ipv4,ipv6:f.ipv6})}static getFbc(e){var t;if(e.fbc)return e.fbc;const i=null!==(t=new URLSearchParams(window.location.search).get("fbclid"))&&void 0!==t?t:void 0,n=i?c.FBC.fromClid(i):void 0,o=null==n?void 0:n.formatted();if(o)return o;return l.AppStorage.getFbc()||o}static getFbp(e){return e.fbp?e.fbp:l.AppStorage.getFbp()}static getGclid(e){var t;return e.gclid?e.gclid:null!==(t=new URLSearchParams(window.location.search).get("gclid"))&&void 0!==t?t:void 0}static getEventData(){return{sourceUrl:document.referrer||null,pageTitle:document.title||null}}}f.inited=!1,f.type="Meta",f.trackedEvents=[],n([a.visibleForTesting,o("design:type",String),o("design:paramtypes",[])],f,"pixelId",null),n([a.visibleForTesting,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",s.Lead)],f,"getLeadFromLocalStorageOrNew",null),n([a.visibleForTesting,o("design:type",Function),o("design:paramtypes",[s.Lead]),o("design:returntype",s.Lead)],f,"getLeadWithBasicFields",null),n([a.visibleForTesting,o("design:type",Function),o("design:paramtypes",[s.Lead]),o("design:returntype",Object)],f,"getFbc",null),n([a.visibleForTesting,o("design:type",Function),o("design:paramtypes",[s.Lead]),o("design:returntype",Object)],f,"getFbp",null),n([a.visibleForTesting,o("design:type",Function),o("design:paramtypes",[s.Lead]),o("design:returntype",Object)],f,"getGclid",null),n([a.visibleForTesting,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Object)],f,"getEventData",null),t.Tracker=f},923:function(e,t){var i=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Utils=void 0;class n{static hashValue(e){return i(this,void 0,void 0,(function*(){if(e&&e.length){if(crypto&&crypto.subtle){const t=(new TextEncoder).encode(e),i=yield crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(i)).map((e=>e.toString(16).padStart(2,"0"))).join("")}return sha256||(yield n.loadScript("https://cdn.jsdelivr.net/npm/js-sha256/src/sha256.min.js")),sha256(e)}}))}static loadScript(e){return i(this,void 0,void 0,(function*(){return new Promise(((t,i)=>{const n=document.createElement("script");n.src=e,n.onload=t,n.onerror=i,document.head.appendChild(n)}))}))}static wait(e){return new Promise((t=>{setTimeout(t,e)}))}static getEventTime(){const e=new Date,t=Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds());return Math.floor(t/1e3)}static getEventDayInMonth(){return(new Date).getDate()}static getEventDay(){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][(new Date).getDay()]}static getEventMonth(){return["January","February","March","April","May","June","July","August","September","October","November","December"][(new Date).getMonth()]}static getEventTimeInterval(){const e=(new Date).getHours();return`${e}-${e+1}`}static getCookieByNames(...e){for(const t of e){const e=t,i=n.getCookieFromStorage(e);if(i)return i}for(const t of e){const e=t,i=n.getCookieFromUrl(e);if(i)return i}return null}static getCookieFromStorage(e){const t=document.cookie.split(";");for(const i of t){const[t,n]=i.trim().split("=");if(t===e)return n}return null}static getCookieFromUrl(...e){const t=new URLSearchParams(window.location.search);for(const i of e)if(t.has(i))return t.get(i);return null}static getId(e){if(e.id)return e.id;const t=n.uuid();return e.id=t,t}static uuid(){const e=()=>Math.floor(65536*(1+Math.random())).toString(16).substring(1);return`${e()+e()}-${e()}-${e()}-${e()}-${e()+e()+e()}`}}t.Utils=n},436:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,i,a):o(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ViewContentListener=void 0;const a=i(370),s=i(526),l=i(923);class c{static init(){c.trackByTime(),c.trackByScroll()}static trackByTime(){return r(this,void 0,void 0,(function*(){yield l.Utils.wait(8e3),s.Tracker.track("ViewContent")}))}static trackByScroll(){return r(this,void 0,void 0,(function*(){window.addEventListener("scroll",(()=>r(this,void 0,void 0,(function*(){console.log("scrolling",window.scrollY),window.scrollY>100&&s.Tracker.track("ViewContent")}))))}))}}n([a.visibleForTesting,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Promise)],c,"trackByTime",null),n([a.visibleForTesting,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Promise)],c,"trackByScroll",null),t.ViewContentListener=c},119:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.InputType=void 0,(i=t.InputType||(t.InputType={})).Name="Name",i.Email="Email",i.Phone="Phone",i.Unknown="Unknown"},937:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Lead=void 0,t.Lead=class{constructor(e){this.pixelId=e.pixelId,this._id=e._id,this.email=e.email,this.firstName=e.firstName,this.lastName=e.lastName,this.phone=e.phone,this.birthdate=e.birthdate,this.metaPixelIds=e.metaPixelIds,this.geolocation=e.geolocation,this.userAgent=e.userAgent,this.ip=e.ip,this.ipv6=e.ipv6,this.fbc=e.fbc,this.fbp=e.fbp,this.gclid=e.gclid,this.parameters=e.parameters,this.updatedAt=e.updatedAt,this.icTextMatch=e.icTextMatch,this.leadTextMatch=e.leadTextMatch}}}},t={};function i(n){var o=t[n];if(void 0!==o)return o.exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,i),r.exports}(()=>{const e=i(526);console.log("Tracker Meta version 1.5.1"),e.Tracker.init("Meta")})()})();